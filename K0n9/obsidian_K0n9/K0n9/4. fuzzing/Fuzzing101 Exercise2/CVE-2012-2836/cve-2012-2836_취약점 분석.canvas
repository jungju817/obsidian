{
	"nodes":[
		{"id":"e0563a9477ab8949","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227062329.png","x":-400,"y":180,"width":1026,"height":66},
		{"id":"f389a450e8a50cb6","type":"text","text":"### backtrace\n","x":48,"y":130,"width":131,"height":50},
		{"id":"0229d4da96c28363","type":"text","text":"## 터지는 원인\n\nbacktrace를 보면 알 수 있겠지만 exif_get_short의 첫 번째 인자가 잘못된 주소가 적혀있는 것을 알 수 있다\n\n### 함수 호출 순서","x":-87,"y":320,"width":400,"height":160},
		{"id":"84f11102a6915dc2","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227072752.png","x":-87,"y":480,"width":400,"height":91},
		{"id":"60231fabc14a6d4d","type":"text","text":"### main.c : main","x":-280,"y":496,"width":193,"height":60},
		{"id":"d701eaa15234573f","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227072912.png","x":-87,"y":640,"width":400,"height":197},
		{"id":"c7eb53481cce9c2e","type":"text","text":"### exif-loader.c : exif_loader_get_data","x":-380,"y":709,"width":293,"height":50},
		{"id":"44a91868ac02db40","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227073016.png","x":-87,"y":900,"width":586,"height":160},
		{"id":"b2b5747f8370d48f","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227073045.png","x":-87,"y":1060,"width":586,"height":168},
		{"id":"9260b126af60d300","type":"text","text":"### exif-data.c : exif_data_load_data","x":-367,"y":1030,"width":280,"height":60},
		{"id":"34a01e9c0e452af9","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227073624.png","x":540,"y":1144,"width":420,"height":156},
		{"id":"0df7413c6d17b852","type":"text","text":"우선 exif_get_short의 인자들을 보자","x":600,"y":1084,"width":250,"height":60},
		{"id":"649ce5777edd4e2e","type":"text","text":"첫 번째 인자가 잘못된 곳을 가리키고 있다. 즉 d + 6 + offset의 값이 문제가 된다. 하지만 d는 data의 주소로 전달받은 값에서 값이 바뀌지 않았다. 아마도 offset에서 문제가 있을 것이다.","x":1020,"y":1066,"width":340,"height":96},
		{"id":"02fc14068370f202","type":"text","text":"IFD0일 경우 offset을 구하는 과정이다. exif_get_long 함수가 쓰였다.","x":1420,"y":1084,"width":250,"height":60},
		{"id":"ce8b296d8f137d9e","type":"text","text":"exif_get_long의 결과로 0xffffffff가 반환되었다. 이 부분이 문제가 되는 것 같다.","x":1495,"y":1460,"width":250,"height":60},
		{"id":"737618e822f38e87","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227074048.png","x":1420,"y":1269,"width":400,"height":179},
		{"id":"ea49972b1bbdf496","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227074149.png","x":1358,"y":1188,"width":524,"height":56},
		{"id":"5ff8be6c4be506b3","type":"text","text":"exif_get_long의 인자들이다. 첫 번째 인자가 가리키는 값이 이상한 것을 알 수 있다.","x":1980,"y":1066,"width":250,"height":60},
		{"id":"6382df0c4b8241f3","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227074625.png","x":1920,"y":1191,"width":399,"height":107},
		{"id":"69583161e36becb8","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227075538.png","x":378,"y":578,"width":325,"height":262},
		{"id":"841e539f066a4c2e","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227075912.png","x":760,"y":584,"width":400,"height":250},
		{"id":"d162c3e5d46cbe9c","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227083133.png","x":817,"y":1797,"width":400,"height":213},
		{"id":"4e70c4bdbe942ed2","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227185105.png","x":6,"y":1359,"width":399,"height":220},
		{"id":"cd04443d1b7b74df","type":"text","text":"# 패치\n6_21에 패치 되었다.\n","x":10,"y":1619,"width":392,"height":141},
		{"id":"e0a2d8e779a007fe","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227082634.png","x":-297,"y":1760,"width":1006,"height":120},
		{"id":"79e41328410fe69d","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227082650.png","x":-293,"y":1909,"width":999,"height":101},
		{"id":"fe5d79d282d5faed","type":"text","text":"패치된 내용은 offset이 loader->bytes_read 보다 크면 return을 시킨다. 참고로 loader->bytes_read는 data의 전체 크기다.","x":28,"y":2060,"width":358,"height":100},
		{"id":"3d8a1924e2204dbe","type":"text","text":"### exif-utils.c : exif_get_short","x":-244,"y":1279,"width":250,"height":80},
		{"id":"728850f1f1253042","type":"text","text":"### exif-utils.c : exif_get_sshort","x":-244,"y":1439,"width":250,"height":60},
		{"id":"28fb4c84449eecb0","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227191254.png","x":1920,"y":1307,"width":398,"height":85},
		{"id":"1c3a2dd58b735a72","type":"text","text":"## 결론\n결론적으로 d + 6 + offset 에서 d의 size인 0x490보다 훨씬 큰 값이 offset으로 들어가면서 잘못된 주소를 참조함으로서 발생하는 문제임을 알 수 있다.\n즉 IFD0의 값을 검증하지 않은 문제이다.","x":2710,"y":1257,"width":460,"height":132},
		{"id":"45b70da904b9b585","type":"text","text":"값이 FFFFFFFF로 이상한 값을 가지고 있는 것을 알 수 있다.","x":2815,"y":1123,"width":250,"height":60},
		{"id":"ea72d9c59cd29347","type":"text","text":"heap의 영역을 벗어난 곳을 참조하는 것을 알 수 있다.","x":2788,"y":1557,"width":306,"height":64},
		{"id":"089121c68cbc7c6e","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227074832.png","x":2653,"y":1063,"width":573,"height":60},
		{"id":"a0a046b00d9f4aad","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227075244.png","x":2536,"y":1437,"width":808,"height":50},
		{"id":"50e38ba2a9384bfb","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227075151.png","x":3170,"y":1257,"width":400,"height":83},
		{"id":"b4301f86d70ec049","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227075308.png","x":2420,"y":1517,"width":1041,"height":23},
		{"id":"47680b6d6b42e4bf","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227191550.png","x":1920,"y":1462,"width":400,"height":186},
		{"id":"497e8feced531147","type":"file","file":"K0n9/4. fuzzing/picture/Pasted image 20231227185044.png","x":6,"y":1260,"width":398,"height":79}
	],
	"edges":[
		{"id":"d48e98c6fddba294","fromNode":"e0563a9477ab8949","fromSide":"bottom","toNode":"0229d4da96c28363","toSide":"top"},
		{"id":"9829ad51159213ac","fromNode":"84f11102a6915dc2","fromSide":"bottom","toNode":"d701eaa15234573f","toSide":"top"},
		{"id":"996ae84be8033e20","fromNode":"d701eaa15234573f","fromSide":"bottom","toNode":"44a91868ac02db40","toSide":"top"},
		{"id":"d35b2310990223d6","fromNode":"b2b5747f8370d48f","fromSide":"right","toNode":"0df7413c6d17b852","toSide":"left"},
		{"id":"496f98fcb808b843","fromNode":"0df7413c6d17b852","fromSide":"right","toNode":"649ce5777edd4e2e","toSide":"left"},
		{"id":"44d997ffb288815b","fromNode":"649ce5777edd4e2e","fromSide":"right","toNode":"02fc14068370f202","toSide":"left"},
		{"id":"e49eec21830f34f5","fromNode":"737618e822f38e87","fromSide":"bottom","toNode":"ce8b296d8f137d9e","toSide":"top"},
		{"id":"2c13965a442eb103","fromNode":"02fc14068370f202","fromSide":"bottom","toNode":"ea49972b1bbdf496","toSide":"top"},
		{"id":"9839784ba17fb237","fromNode":"ea49972b1bbdf496","fromSide":"bottom","toNode":"737618e822f38e87","toSide":"top"},
		{"id":"d0f27720e872cfc1","fromNode":"02fc14068370f202","fromSide":"right","toNode":"5ff8be6c4be506b3","toSide":"left"},
		{"id":"abc020ef2b58fd47","fromNode":"5ff8be6c4be506b3","fromSide":"bottom","toNode":"6382df0c4b8241f3","toSide":"top"},
		{"id":"12b1852d702ee40d","fromNode":"5ff8be6c4be506b3","fromSide":"right","toNode":"089121c68cbc7c6e","toSide":"left"},
		{"id":"8b45528e548acc2f","fromNode":"45b70da904b9b585","fromSide":"bottom","toNode":"1c3a2dd58b735a72","toSide":"top"},
		{"id":"739cefcd92bc0033","fromNode":"1c3a2dd58b735a72","fromSide":"bottom","toNode":"a0a046b00d9f4aad","toSide":"top"},
		{"id":"1dfe43b51c7e9125","fromNode":"a0a046b00d9f4aad","fromSide":"bottom","toNode":"b4301f86d70ec049","toSide":"top"},
		{"id":"395642e7a666fcaf","fromNode":"b4301f86d70ec049","fromSide":"bottom","toNode":"ea72d9c59cd29347","toSide":"top"},
		{"id":"209713aea5696d7d","fromNode":"d701eaa15234573f","fromSide":"right","toNode":"69583161e36becb8","toSide":"left"},
		{"id":"d7ad1fb08020d692","fromNode":"69583161e36becb8","fromSide":"right","toNode":"841e539f066a4c2e","toSide":"left"},
		{"id":"9a446741a537e651","fromNode":"e0a2d8e779a007fe","fromSide":"bottom","toNode":"79e41328410fe69d","toSide":"top"},
		{"id":"cb6ed985347b9f57","fromNode":"79e41328410fe69d","fromSide":"right","toNode":"d162c3e5d46cbe9c","toSide":"left"},
		{"id":"3535af4e07b6eab1","fromNode":"79e41328410fe69d","fromSide":"bottom","toNode":"fe5d79d282d5faed","toSide":"top"},
		{"id":"1eedaa488222fc3f","fromNode":"b2b5747f8370d48f","fromSide":"bottom","toNode":"497e8feced531147","toSide":"top"},
		{"id":"7c18249eed945b87","fromNode":"497e8feced531147","fromSide":"bottom","toNode":"4e70c4bdbe942ed2","toSide":"top"},
		{"id":"9587d70997640074","fromNode":"4e70c4bdbe942ed2","fromSide":"bottom","toNode":"cd04443d1b7b74df","toSide":"top"},
		{"id":"924cb2e72ee788e5","fromNode":"6382df0c4b8241f3","fromSide":"bottom","toNode":"28fb4c84449eecb0","toSide":"top"},
		{"id":"124450e3ac1a5bfe","fromNode":"28fb4c84449eecb0","fromSide":"bottom","toNode":"47680b6d6b42e4bf","toSide":"top"}
	]
}