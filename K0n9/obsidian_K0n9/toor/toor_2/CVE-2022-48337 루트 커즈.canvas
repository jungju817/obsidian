{
	"nodes":[
		{"id":"7b96143f19f66c66","type":"text","text":"concat 함수","x":1249,"y":440,"width":162,"height":60,"color":"5"},
		{"id":"427e695a33a0a401","type":"text","text":"```c\nstatic char * \nconcat (const char *s1, const char *s2, const char *s3)\n{\n  ptrdiff_t len1 = strlen (s1), len2 = strlen (s2), len3 = strlen (s3);\n  char *result = xnew (len1 + len2 + len3 + 1, char);\n  strcpy (stpcpy (stpcpy (result, s1), s2), s3);\n  return result;\n}\n```","x":996,"y":500,"width":668,"height":270,"color":"5"},
		{"id":"48841b7526d12e1c","type":"text","text":"```c\nchar *cmd1 = concat (compr->command, \" '\", real_name);\n```\n첫 번째 인자 = compr->command : \"gzip -d -c \"\n두 번째 인자 = \" '\"\n세 번째 인자 = real_name : \"';sh;'test.z\"\n\n여기서 -d -c 는 압축된 파일 해제 후 결과를 표준 출력하는 옵션이다.\n\n그 결과 cmd1 에는 \"gzip -d -c '';sh;'test.z\" 라는 문자열이 저장된","x":996,"y":798,"width":629,"height":302,"color":"4"},
		{"id":"b951ba09d247303f","type":"text","text":"```c\n#if MSDOS || defined (DOS_NT)  \n      char *cmd1 = concat (compr->command, \" \\\"\", real_name);\n      char *cmd = concat (cmd1, \"\\\" > \", tmp_name); \n```","x":-920,"y":582,"width":549,"height":150},
		{"id":"af2765f1aa0f4458","type":"text","text":"실행되지 않는 코드","x":-770,"y":522,"width":230,"height":60},
		{"id":"d4e09eddbef43692","type":"text","text":"```c\n#else\n      char *cmd1 = concat (compr->command, \" '\", real_name);\n      char *cmd = concat (cmd1, \"' > \", tmp_name);\n#endif\n      free (cmd1);\n      inf = (system (cmd) == -1\n         ? NULL\n         : fopen (tmp_name, \"r\" FOPEN_BINARY));\n      free (cmd);\n    }\n```","x":60,"y":665,"width":600,"height":316,"color":"#db715c"},
		{"id":"b0d7087acd238af4","type":"text","text":"실행되는 코드","x":278,"y":605,"width":165,"height":60,"color":"#db715c"},
		{"id":"eed411427602e16e","type":"text","text":"```c\nchar *cmd = concat (cmd1, \"' > \", tmp_name);\n```\n\n첫 번째 인자 = cmd1 : \"gzip -d -c '';sh;'test.z\" \n두 번째 인자 = \"' > \"\n세 번째 인자 = tmp_name : \"/tmp/etJxHXhG\"\n\n여기서 tmp_name은 /tmp/etJxHXhG 는 TMPDIR이라 환경변수이다.\n\n그 결과 cmd 에는 \"gzip -d -c '';sh;'test.z' > /tmp/etJxHXhG\" 라는 문자열이 저장된다.\n참고로 위의 명령어는 기본적으로 해당 파일을 압축해제한 후 /tmp/dtJxHXhG로 저장한다는 뜻이다","x":996,"y":1157,"width":668,"height":363,"color":"#a5cb52"},
		{"id":"75bdcc1cc02c6a2f","type":"file","file":"toor/picture/Pasted image 20231103000054.png","x":1860,"y":405,"width":979,"height":520},
		{"id":"7f87d8912f33875c","type":"file","file":"toor/picture/Pasted image 20231103000235.png","x":1860,"y":981,"width":873,"height":50},
		{"id":"3fff3c0b2498f2f2","type":"file","file":"toor/picture/Pasted image 20231103000723.png","x":1860,"y":1157,"width":979,"height":589},
		{"id":"8e00a2b806276f92","type":"text","text":"```c\n//루트 커즈\n#if MSDOS || defined (DOS_NT)  \n      char *cmd1 = concat (compr->command, \" \\\"\", real_name);\n      char *cmd = concat (cmd1, \"\\\" > \", tmp_name); \n#else\n      char *cmd1 = concat (compr->command, \" '\", real_name);\n      char *cmd = concat (cmd1, \"' > \", tmp_name);\n#endif\n      free (cmd1);\n      inf = (system (cmd) == -1\n         ? NULL\n         : fopen (tmp_name, \"r\" FOPEN_BINARY));\n      free (cmd);\n    }\n```\n","x":60,"y":100,"width":600,"height":282,"color":"1"},
		{"id":"fdacae9f28ce63ec","type":"text","text":"```c\n      free (cmd1);\n      inf = (system (cmd) == -1\n         ? NULL\n         : fopen (tmp_name, \"r\" FOPEN_BINARY));\n      free (cmd);\n    }\n```\n필요가 없어진 cmd1는 free한다.\n\nsystem (cmd) 를 한다.\n\nsystem (\"gzip -d -c '';sh;'test.z' > /tmp/etJxHXhG\") 가 실행된다. \n그런데 shell metacharacter 인 ;로 인해 sh 가 실행이 돼서 셸이 따진다.","x":60,"y":1080,"width":600,"height":320,"color":"#f49090"}
	],
	"edges":[
		{"id":"72b831c8eb6f7941","fromNode":"d4e09eddbef43692","fromSide":"right","toNode":"427e695a33a0a401","toSide":"left"},
		{"id":"cd5d62e0b901b2e1","fromNode":"d4e09eddbef43692","fromSide":"right","toNode":"48841b7526d12e1c","toSide":"left"},
		{"id":"8d4f061623f37b9c","fromNode":"8e00a2b806276f92","fromSide":"bottom","toNode":"af2765f1aa0f4458","toSide":"top"},
		{"id":"72d89aa002de12e5","fromNode":"8e00a2b806276f92","fromSide":"bottom","toNode":"b0d7087acd238af4","toSide":"top"},
		{"id":"9dc5aa67008ba06d","fromNode":"48841b7526d12e1c","fromSide":"right","toNode":"75bdcc1cc02c6a2f","toSide":"left"},
		{"id":"d2172c9b929d12e6","fromNode":"48841b7526d12e1c","fromSide":"right","toNode":"7f87d8912f33875c","toSide":"left"},
		{"id":"e9728028d8190f22","fromNode":"eed411427602e16e","fromSide":"right","toNode":"3fff3c0b2498f2f2","toSide":"left"},
		{"id":"75e3b681b103e8f5","fromNode":"d4e09eddbef43692","fromSide":"right","toNode":"eed411427602e16e","toSide":"left"},
		{"id":"62d46af11a92e08c","fromNode":"d4e09eddbef43692","fromSide":"bottom","toNode":"fdacae9f28ce63ec","toSide":"top"}
	]
}